<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pong AI | Neron's Hub</title>
    <style>
        :root { --sidebar-width: 260px; --accent: #6366f1; --bg: #f8fafc; --text: #1e293b; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: sans-serif; background: var(--bg); color: var(--text); display: flex; min-height: 100vh; }
        
        /* Sidebar */
        nav { width: var(--sidebar-width); background: #fff; border-right: 1px solid #e2e8f0; padding: 2rem; position: fixed; height: 100vh; }
        nav ul { list-style: none; margin-top: 2rem; }
        nav li { margin-bottom: 1rem; }
        nav a { text-decoration: none; color: #64748b; font-weight: 600; }

        /* Main Content */
        main { margin-left: var(--sidebar-width); flex-grow: 1; padding: 2rem; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        canvas { background: #000; border: 4px solid var(--accent); border-radius: 12px; display: block; }
        .score { font-size: 2rem; font-weight: bold; margin-bottom: 1rem; font-family: monospace; }

        @media (max-width: 768px) {
            body { flex-direction: column; }
            nav { width: 100%; height: auto; position: relative; padding: 1rem; }
            main { margin-left: 0; }
        }
    </style>
</head>
<body>
    <nav>
        <div style="font-weight: bold; color: #94a3b8; font-size: 0.8rem;">NAVIGATION</div>
        <ul>
            <li><a href="../index.html">Home</a></li>
            <li><a href="../games.html" style="color: var(--accent);">Arcade</a></li>
        </ul>
    </nav>

    <main>
        <div class="score"><span id="pS">0</span> : <span id="cS">0</span></div>
        <canvas id="pongCanvas"></canvas>
        <p style="margin-top: 10px; color: #64748b;">W/S or Arrows to move</p>
    </main>

    <script>
        // Use a self-executing function to avoid conflicts
        (function() {
            const canvas = document.getElementById("pongCanvas");
            const ctx = canvas.getContext("2d");

            // Set fixed dimensions
            canvas.width = 600;
            canvas.height = 400;

            let pScore = 0, cScore = 0;
            const pW = 12, pH = 80;
            
            let user = { x: 10, y: 160, dy: 0 };
            let com = { x: 578, y: 160 };
            let ball = { x: 300, y: 200, r: 7, spd: 5, dx: 5, dy: 5 };

            document.addEventListener("keydown", e => {
                if(e.key == "ArrowUp" || e.key == "w") user.dy = -7;
                if(e.key == "ArrowDown" || e.key == "s") user.dy = 7;
            });

            document.addEventListener("keyup", e => {
                if(e.key == "ArrowUp" || e.key == "w" || e.key == "ArrowDown" || e.key == "s") user.dy = 0;
            });

            function reset() {
                ball.x = 300; ball.y = 200;
                ball.spd = 5; ball.dx = -ball.dx;
            }

            function update() {
                user.y += user.dy;
                if(user.y < 0) user.y = 0;
                if(user.y > 400 - pH) user.y = 400 - pH;

                ball.x += ball.dx; ball.y += ball.dy;

                // Simple AI
                if(ball.x > 300) {
                    com.y += (ball.y - (com.y + pH/2)) * 0.07;
                }

                if(ball.y + ball.r > 400 || ball.y - ball.r < 0) ball.dy = -ball.dy;

                let player = (ball.x < 300) ? user : com;
                if(ball.x + ball.r > player.x && ball.x - ball.r < player.x + pW && ball.y > player.y && ball.y < player.y + pH) {
                    let collidePoint = (ball.y - (player.y + pH/2)) / (pH/2);
                    let angle = (Math.PI/4) * collidePoint;
                    let dir = (ball.x < 300) ? 1 : -1;
                    ball.dx = dir * ball.spd * Math.cos(angle);
                    ball.dy = ball.spd * Math.sin(angle);
                    ball.spd += 0.2;
                }

                if(ball.x < 0) { cScore++; document.getElementById("cS").innerText = cScore; reset(); }
                if(ball.x > 600) { pScore++; document.getElementById("pS").innerText = pScore; reset(); }
            }

            function draw() {
                ctx.fillStyle = "#000";
                ctx.fillRect(0, 0, 600, 400);

                // Paddles
                ctx.fillStyle = "#6366f1";
                ctx.fillRect(user.x, user.y, pW, pH);
                ctx.fillStyle = "#fff";
                ctx.fillRect(com.x, com.y, pW, pH);

                // Ball
                ctx.beginPath();
                ctx.arc(ball.x, ball.y, ball.r, 0, Math.PI*2);
                ctx.fill();

                update();
                requestAnimationFrame(draw);
            }

            console.log("Pong initialized");
            draw();
        })();
    </script>
</body>
</html>
